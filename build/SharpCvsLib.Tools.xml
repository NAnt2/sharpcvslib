<project name="SharpCvsLibTools">
    <target name="InstallTools" depends="InstallBuilder, InstallNAntExtras">
    </target>
    
    <target name="InstallNAntExtras">
        <exec   program="${nant.location}nant.exe"
                workingdir="${dir.tools}/nant/opt/build"
                >
            <arg value="-D:Configuration=${Configuration}"/>
            <arg value="Build"/>
        </exec>
        <nant buildfile="${dir.tools}/nant/opt/build/NAntExtras.build"/>
        <mkdir dir="${dir.bin}/working"/>
        <copy todir="${dir.bin}/working">
            <fileset basedir="${dir.tools}/nant/opt/bin/${Configuration}">
                <include name="Sporadicism.NAntExtras.dll"/>
            </fileset>
        </copy>
    </target>
    
    <target name="InstallBuilder" depends="InstallNAntExtras">
        <loadtasks assembly="${dir.bin}/working/Sporadicism.NAntExtras.dll" />
        <exec   program="${nant.location}nant.exe"
                workingdir="${dir.tools}/Builder/build"
                >
            <arg value="-D:Configuration=${Configuration}"/>
            <arg value="Build"/>
        </exec>

        <sysinfo/>

        <property name="installLink" value="${sys.env.USERPROFILE}\Desktop\Sporadicism Builder.lnk"/>
        <ifnot test="${file::exists(installLink)}">
            <delete file="${installLink}" failonerror="false"/>
            <echo message="Shortcut created at ${Shortcut::Create(dir.tools + '\Builder\bin\' + ToolConfig + '\Builder.exe', installLink)}"/>
        </ifnot>    
    </target>
    
    <target name="CleanTools">
        <nant target="Clean">
            <buildfiles>
                <include name="${dir.tools}/Builder/build/Builder.build"/>
                <include name="${dir.tools}/nant/opt/build/NAntExtras.build"/>
            </buildfiles>
        </nant>    
    </target>
</project>