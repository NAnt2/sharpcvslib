
<!--
    Build file for the sharpcvsaddin library files.
-->
<project name="SharpCvsAddIn" default="build">
	<!-- path for some assemblies, you'll need to change this if you have visual studion installed to a non-standard place -->
	<property name="addin.ideasm.path" value="c:\program files\Microsoft Visual Studio .NET 2003\Common7\IDE\PublicAssemblies" />
    <target name="build">
        <csc    target="library" 
                warnaserror="${compile.warnaserror}" 
                output="${dir.bin}/${name.addin}.dll" 
                debug="${compile.debug}" 
                define="${compile.define}" 
                doc="${dir.bin}/${name.addin}.xml">
            <nowarn>
                <!-- do not report deprecation warnings if not a release build -->
                <warning number="0618" if="${string::contains(BuildType, 'debug')}" />
                <!-- do not report missing documentation warnings if not a release build -->
                <warning number="1591" if="${string::contains(BuildType, 'debug')}"/>
                <warning number="1587" />
            </nowarn>

                
            <arg value="${compile.unsafe}" />
            <arg value="${compile.checked}" />
            
            <sources basedir="${dir.src}/${name.addin}">
                <include name="**/*.cs" />
            </sources>
            
            <resources prefix="${name.addin}" >
				<include name="**/*.bmp" />
				<include name="**/*.resx" />
            </resources> 
            
            <references>
				<include name="EnvDTE.dll" />
				<include name="${addin.ideasm.path}/Extensibility.dll" />
				<include name="Office.dll" />
                <include name="${dir.lib.ext}/${lib.log4net}" />
                <include name="${dir.bin}/${name.top-level}.${name.project}.dll" />
                <include name="System.dll" />
                <include name="System.Drawing.dll" />
                <include name="System.Windows.Forms.dll" />
                <include name="System.XML.dll" />
            </references>            
        </csc>
        
    
        <nant buildfile="addin-resources.build.xml" >
			<properties>
				<property name="config" value="${BuildType}" />
				<property name="outputdir" value="${dir.bin}" />			
			</properties>
        </nant>
        
        <copy todir="${dir.bin}">
			<fileset basedir="${dir.src}/${name.addin}/bin/${BuildType}">
				<include name="sharpcvsaddin-log.config" />
				<include name="language-assembly.dll" />
			</fileset>
        </copy> 
    </target>
</project>
